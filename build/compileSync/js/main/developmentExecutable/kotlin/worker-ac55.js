(function (factory) {
  if (typeof define === 'function' && define.amd)
    define(['exports', './kotlin-kotlin-stdlib.js', './kobweb-frontend-kobweb-worker-interface.js', './kobweb-frontend-kobweb-worker.js'], factory);
  else if (typeof exports === 'object')
    factory(module.exports, require('./kotlin-kotlin-stdlib.js'), require('./kobweb-frontend-kobweb-worker-interface.js'), require('./kobweb-frontend-kobweb-worker.js'));
  else {
    if (typeof globalThis['kotlin-kotlin-stdlib'] === 'undefined') {
      throw new Error("Error loading module 'worker-ac55'. Its dependency 'kotlin-kotlin-stdlib' was not found. Please, check whether 'kotlin-kotlin-stdlib' is loaded prior to 'worker-ac55'.");
    }
    if (typeof globalThis['kobweb-frontend-kobweb-worker-interface'] === 'undefined') {
      throw new Error("Error loading module 'worker-ac55'. Its dependency 'kobweb-frontend-kobweb-worker-interface' was not found. Please, check whether 'kobweb-frontend-kobweb-worker-interface' is loaded prior to 'worker-ac55'.");
    }
    if (typeof globalThis['kobweb-frontend-kobweb-worker'] === 'undefined') {
      throw new Error("Error loading module 'worker-ac55'. Its dependency 'kobweb-frontend-kobweb-worker' was not found. Please, check whether 'kobweb-frontend-kobweb-worker' is loaded prior to 'worker-ac55'.");
    }
    globalThis['worker-ac55'] = factory(typeof globalThis['worker-ac55'] === 'undefined' ? {} : globalThis['worker-ac55'], globalThis['kotlin-kotlin-stdlib'], globalThis['kobweb-frontend-kobweb-worker-interface'], globalThis['kobweb-frontend-kobweb-worker']);
  }
}(function (_, kotlin_kotlin, kotlin_com_varabyte_kobweb_kobweb_worker_interface, kotlin_com_varabyte_kobweb_kobweb_worker) {
  'use strict';
  //region block: imports
  var Unit_getInstance = kotlin_kotlin.$_$.m4;
  var THROW_CCE = kotlin_kotlin.$_$.mf;
  var StringBuilder_init_$Create$ = kotlin_kotlin.$_$.e1;
  var Companion_getInstance = kotlin_com_varabyte_kobweb_kobweb_worker_interface.$_$.d;
  var WorkerContext = kotlin_com_varabyte_kobweb_kobweb_worker_interface.$_$.a;
  var VOID = kotlin_kotlin.$_$.f;
  var protoOf = kotlin_kotlin.$_$.fc;
  var to = kotlin_kotlin.$_$.qg;
  var json = kotlin_kotlin.$_$.xb;
  var add = kotlin_kotlin.$_$.ja;
  var postInput$default = kotlin_com_varabyte_kobweb_kobweb_worker_interface.$_$.c;
  var Worker_0 = kotlin_com_varabyte_kobweb_kobweb_worker_interface.$_$.b;
  var initMetadataForClass = kotlin_kotlin.$_$.cb;
  var WorkerStrategy = kotlin_com_varabyte_kobweb_kobweb_worker.$_$.b;
  var createPassThroughSerializer = kotlin_com_varabyte_kobweb_kobweb_worker.$_$.c;
  var WorkerFactory = kotlin_com_varabyte_kobweb_kobweb_worker.$_$.a;
  //endregion
  //region block: pre-declaration
  initMetadataForClass(EchoWorker, 'EchoWorker', EchoWorker, VOID, [Worker_0]);
  initMetadataForClass(EchoWorkerFactory, 'EchoWorkerFactory', EchoWorkerFactory, VOID, [WorkerFactory]);
  //endregion
  function _get_ioSerializer__cezf1v($this) {
    return $this.ioSerializer_1;
  }
  function _get_worker__80fttf($this) {
    return $this.worker_1;
  }
  function EchoWorker$_init_$lambda_s3ddo8(_this__u8e3s4, it) {
    return Unit_getInstance();
  }
  function EchoWorker$worker$lambda(this$0) {
    return function (e) {
      // Inline function 'kotlin.js.unsafeCast' call
      // Inline function 'kotlin.js.asDynamic' call
      var json = e.data;
      var tmp;
      try {
        var tmp_0 = json['_output'];
        tmp = this$0.ioSerializer_1.deserializeOutput_u4geee_k$((!(tmp_0 == null) ? typeof tmp_0 === 'string' : false) ? tmp_0 : THROW_CCE());
      } catch ($p) {
        var tmp_1;
        if ($p instanceof Error) {
          var e_0 = $p;
          var tmp_2 = console;
          // Inline function 'kotlin.text.buildString' call
          // Inline function 'kotlin.apply' call
          var this_0 = StringBuilder_init_$Create$();
          // Inline function 'org.akilincarslan.ahrarwood.worker.EchoWorker.worker.<anonymous>.<anonymous>.<anonymous>' call
          this_0.append_22ad7x_k$('Unable to deserialize output generated by worker, ignoring it.');
          var tmp0_safe_receiver = e_0.message;
          if (tmp0_safe_receiver == null)
            null;
          else {
            // Inline function 'kotlin.let' call
            // Inline function 'org.akilincarslan.ahrarwood.worker.EchoWorker.worker.<anonymous>.<anonymous>.<anonymous>.<anonymous>' call
            this_0.append_22ad7x_k$('\nException: ' + tmp0_safe_receiver);
          }
          var tmp$ret$4 = this_0.toString();
          tmp_2.warn(tmp$ret$4);
          tmp_1 = null;
        } else {
          throw $p;
        }
        tmp = tmp_1;
      }
      var outputDeserialized = tmp;
      var tmp_3;
      if (!(outputDeserialized == null)) {
        var ctx = new WorkerContext(Companion_getInstance().fromJson_9k5biu_k$(json));
        tmp_3 = this$0.onOutput_1(ctx, outputDeserialized);
      }
      return Unit_getInstance();
    };
  }
  function EchoWorker(onOutput) {
    var tmp;
    if (onOutput === VOID) {
      tmp = EchoWorker$_init_$lambda_s3ddo8;
    } else {
      tmp = onOutput;
    }
    onOutput = tmp;
    this.onOutput_1 = onOutput;
    this.ioSerializer_1 = (new EchoWorkerFactory()).createIOSerializer_7o833g_k$();
    var tmp_0 = this;
    // Inline function 'kotlin.apply' call
    var this_0 = new Worker('_kobweb/workers/org-akilincarslan-ahrarwood-worker/worker-ac55.js');
    // Inline function 'org.akilincarslan.ahrarwood.worker.EchoWorker.worker.<anonymous>' call
    this_0.onmessage = EchoWorker$worker$lambda(this);
    tmp_0.worker_1 = this_0;
  }
  protoOf(EchoWorker).set_onOutput_p6jva1_k$ = function (_set____db54di) {
    this.onOutput_1 = _set____db54di;
  };
  protoOf(EchoWorker).set_onOutput_sdwly_k$ = function (_set____db54di) {
    return this.set_onOutput_p6jva1_k$(_set____db54di);
  };
  protoOf(EchoWorker).get_onOutput_8rn3p3_k$ = function () {
    return this.onOutput_1;
  };
  protoOf(EchoWorker).postInput_b3phlf_k$ = function (input, transferables) {
    var tmp;
    try {
      tmp = this.ioSerializer_1.serializeInput_6cf2ds_k$(input);
    } catch ($p) {
      var tmp_0;
      if ($p instanceof Error) {
        var e = $p;
        tmp_0 = null;
      } else {
        throw $p;
      }
      tmp = tmp_0;
    }
    var inputSerialized = tmp;
    if (!(inputSerialized == null)) {
      this.worker_1.postMessage(add(json([to('_input', inputSerialized)]), transferables.toJson_edh1bx_k$()), transferables.toValues_s9cf43_k$());
    }
  };
  protoOf(EchoWorker).postInput_ghty3x_k$ = function (input, transferables) {
    return this.postInput_b3phlf_k$((!(input == null) ? typeof input === 'string' : false) ? input : THROW_CCE(), transferables);
  };
  protoOf(EchoWorker).terminate_hmb9m7_k$ = function () {
    this.worker_1.terminate();
  };
  function EchoWorkerFactory$createStrategy$lambda($postOutput) {
    return function ($this$WorkerStrategy, input) {
      $postOutput.invoke$default_cfi2p6_k$(input);
      return Unit_getInstance();
    };
  }
  function EchoWorkerFactory() {
  }
  protoOf(EchoWorkerFactory).createStrategy_xvz9rq_k$ = function (postOutput) {
    return WorkerStrategy(EchoWorkerFactory$createStrategy$lambda(postOutput));
  };
  protoOf(EchoWorkerFactory).createStrategy_l6chc7_k$ = function (postOutput) {
    return this.createStrategy_xvz9rq_k$(postOutput);
  };
  protoOf(EchoWorkerFactory).createIOSerializer_7o833g_k$ = function () {
    return createPassThroughSerializer(this);
  };
  //region block: post-declaration
  protoOf(EchoWorker).postInput$default_21bd8p_k$ = postInput$default;
  //endregion
  //region block: exports
  _.$_$ = _.$_$ || {};
  _.$_$.a = EchoWorker;
  //endregion
  return _;
}));

//# sourceMappingURL=worker-ac55.js.map
